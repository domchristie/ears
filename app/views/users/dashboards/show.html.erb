<%= render "container" do %>

  <% if @dashboard.recently_played.any? %>
    <%= render("heading", icon: :play) { "Recently Played" } %>

    <div class="flex flex-nowrap space-x-4 pb-4 overflow-x-auto transform-gpu">
      <% @dashboard.recently_played.each do |feed| %>
        <% play = feed.most_recent_play_by(Current.user) %>
        <%= render "feeds/featured", feed: feed do %>
          <% unless play.complete? %>
            <div class="flex items-center absolute top-1.5 left-1.5 whitespace-nowrap px-1.5 leading-5 bg-white/95 text-neutral-600 text-xs font-medium">
              <%= render "plays/play", play: play %>
            </div>
          <% end %>
        <% end %>
      <% end %>
    </div>
  <% end %>

  <% if @dashboard.recently_updated.any? %>
    <%= render("heading", icon: :sparkles) { "Recently Updated" } %>

    <div class="flex flex-nowrap space-x-4 pb-4 overflow-x-auto transform-gpu">
      <% @dashboard.recently_updated.each do |feed| %>
        <%= render "feeds/featured", feed: feed do %>
          <p class="flex items-center absolute bottom-1.5 left-1.5 whitespace-nowrap px-1.5 leading-5 bg-white/95 text-neutral-600 text-xs font-medium">
            <span class="sr-only">Updated on</span>
            <%= local_relative_time(
              feed.most_recent_entry.published_at,
              type: :weekday,
              class: "capitalize"
            ) %>
          </p>

          <% if play = feed.most_recent_entry.most_recent_play_by(Current.user) %>
            <div class="flex items-center absolute top-1.5 left-1.5 whitespace-nowrap px-1.5 leading-5 bg-white/95 text-neutral-600 text-xs font-medium">
              <%= render "plays/play", play: play %>
            </div>
          <% end %>
        <% end %>
      <% end %>
    </div>
  <% end %>

  <% if @dashboard.feeds.any? %>
    <%= render("heading", icon: :collection) { "Your Feeds" } %>

    <%= render "list" do %>
      <%= render partial: "feeds/feed", collection: @dashboard.feeds %>
    <% end %>
  <% end %>
<% end %>
