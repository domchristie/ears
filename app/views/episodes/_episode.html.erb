<%
yield(episode_partial = component_partial) if block_given?
parts ||= [:feed, :description, :play, :play_later]
%>

<%= render "list_item", title: episode.title, path: entry_path(episode.entry), color: :accent, contain: true do |p| %>
  <% if parts.include?(:feed) %>
    <% p.content_for :kicker do %>
      <p class="flex items-center text-grey-500 dark:text-grey-400">
        <span class="relative w-6 h-6 shrink-0 mr-2 before:absolute before:inset-0 before:ring-inset before:ring-1 before:ring-black/10 dark:before:ring-white/10">
          <% if episode.feed.image_url %>
            <%= image_tag ExternalImage.url(episode.feed.image_url), alt: "", width: 24, height: 24, loading: :lazy %>
          <% end %>
        </span>
        <span class="truncate"><%= episode.feed.title %></span>
      </p>
    <% end %>
  <% end %>

  <div class="flex space-x-4 text-sm font-medium text-grey-500 dark:text-grey-400">
    <div class="flex items-center">
      <%= icon :calendar, solid: true, class: "h-4 w-4 mr-1 text-grey-300 dark:text-grey-600 -translate-y-px" %>
      <%= local_relative_time episode.published_at, type: "date", class: "uppercase" %>
    </div>

    <%= render "plays/play", play: episode.play %>
  </div>

  <div class="space-y-fl-3xs">
    <% if parts.include?(:description) %>
      <div class="text-grey-500 dark:text-grey-400 line-clamp-1 break-all">
        <%= strip_tags (episode.summary || episode.description).to_s %>
      </div>
    <% end %>

    <%= render "episodes/actions", episode: %>
  </div>

  <% if episode_partial&.content_for?(:actions) %>
    <% p.content_for :actions do %>
      <div class="flex h-full items-center justify-center">
        <%= episode_partial.content_for(:actions) %>
      </div>
    <% end %>
  <% end %>
<% end %>
